/*! Combo2 1.1.6
 * Copyright (c) 2016-2018 Stephen Rolfe Nielsen
 *
 * https://github.com/srolfe26/combo2
 *
 * @license MIT 2016-2018 Stephen Rolfe Nielsen
 */ 

!function(e,t,n){"undefined"!=typeof module&&module.exports?module.exports=n():e[t]=n()}(this,"verge",function(){function e(){return{width:c(),height:d()}}function t(e,t){var n={};return t=+t||0,n.width=(n.right=e.right+t)-(n.left=e.left-t),n.height=(n.bottom=e.bottom+t)-(n.top=e.top-t),n}function n(e,n){return e=e&&!e.nodeType?e[0]:e,e&&1===e.nodeType?t(e.getBoundingClientRect(),n):!1}function i(t){t=null==t?e():1===t.nodeType?n(t):t;var i=t.height,r=t.width;return i="function"==typeof i?i.call(t):i,r="function"==typeof r?r.call(t):r,r/i}var r={},a="undefined"!=typeof window&&window,o="undefined"!=typeof document&&document,s=o&&o.documentElement,l=a.matchMedia||a.msMatchMedia,u=l?function(e){return!!l.call(a,e).matches}:function(){return!1},c=r.viewportW=function(){var e=s.clientWidth,t=a.innerWidth;return t>e?t:e},d=r.viewportH=function(){var e=s.clientHeight,t=a.innerHeight;return t>e?t:e};return r.mq=u,r.matchMedia=l?function(){return l.apply(a,arguments)}:function(){return{}},r.viewport=e,r.scrollX=function(){return a.pageXOffset||s.scrollLeft},r.scrollY=function(){return a.pageYOffset||s.scrollTop},r.rectangle=n,r.aspect=i,r.inX=function(e,t){var i=n(e,t);return!!i&&i.right>=0&&i.left<=c()},r.inY=function(e,t){var i=n(e,t);return!!i&&i.bottom>=0&&i.top<=d()},r.inViewport=function(e,t){var i=n(e,t);return!!i&&i.bottom>=0&&i.right>=0&&i.top<=d()&&i.left<=c()},r}),jQuery.extend(verge),window.Wui=function(){return Wui||{}},Wui.id=function(e){return e=Wui.isset(e)&&e.length&&e.length>0?e:"wui",e+"-"+(Wui.idCounter=~~++Wui.idCounter)},Wui.isset=function(e){return"undefined"!=typeof e},Wui.maxZ=function(e){var t=e instanceof jQuery?e[0]:e,n=$("body *"),i=n.length<2500?n:$('body > *, [style*="z-index"]'),r=Math.max.apply(null,$.map(i,function(e){return"static"!=$(e).css("position")&&e!=t?parseInt($(e).css("z-index"))||0:void 0}));return($.isNumeric(r)?r:0)+1},Wui.isPercent=function(e){return e=String(e),-1!=e.indexOf("%")&&$.isNumeric(parseFloat(e))},Wui.getScrollbarWidth=function(){var e,t;return void 0===Wui.scrollbarWidth&&(e=$('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),t=e.children(),Wui.scrollbarWidth=t.innerWidth()-t.height(99).innerWidth(),e.remove()),Wui.scrollbarWidth},Wui.getStylesForElement=function(e){var t={};Array.prototype.slice.call(document.styleSheets).forEach(function(n){n.hasOwnProperty("rules")&&Array.prototype.slice.call(n.rules).forEach(function(i){n.rule&&i.selectorText.split(",").forEach(function(n){if(e.matches(n))for(var r=0;r<i.style.length;++r){var a=i.style[r];t[a]=i.style[a]}})})});var n=e.style;return $.each(n,function(e,i){t[i]=n[i]}),t},Wui.parseSelect=function(e){var t=[],n=$(e).find("option");return n.each(function(e,n){var i=$(n),r=i.parent("optgroup"),a=r.prop("disabled")||i.prop("disabled");t.push({element:i,index:e,value:a?null:i.val(),label:i.text(),optgroup:r.attr("label")||"",disabled:a})}),t},Wui.percentToPixels=function(e,t,n){var i=e.parent(),r=i[0]===$(window)[0]||i[0]===$("html")[0]||i[0]===$("body")[0],a=r?"height"==n?$.viewportH():$.viewportW():i[n]();return Math.floor(parseFloat(t)/100*a)},Wui.positionItem=function(e,t){var n,i=e[0].getBoundingClientRect(),r=i.top,a=t.outerWidth(),o=i.top,s=$.viewportH()-o-e.outerHeight(),l=s>o,u=i.left+e.outerWidth()-a>0;t.css({"max-height":(l?s:o)-15}),n=t.outerHeight(),r=l?r+e.outerHeight():r-($.isNumeric(n)?n:t.outerHeight()),t.css({left:u?i.left+e.outerWidth()-a:i.left,top:r,position:"fixed",zIndex:Wui.maxZ(t)})},Wui.unwrapData=function(e){var t=this,n=t.hasOwnProperty("dataContainer")?t.dataContainer:Wui.Data.prototype.dataContainer,i=t.hasOwnProperty("totalContainer")?t.totalContainer:Wui.Data.prototype.totalContainer,r=n&&e[n]?e[n]:e,a=i&&e[i]?e[i]:r.length;return{data:r,total:a}},Wui.Data=function(e){$.extend(this,{ajaxConfig:{},data:[],name:null,params:{},total:0,url:null},e)},Wui.Data.prototype={afterSet:function(){},beforeLoad:function(){},beforeSet:function(){},dataChanged:function(){},dataContainer:null,dataEach:function(e){for(var t=0;t<this.data.length&&e(this.data[t],t)!==!1;t++);return!0},failure:function(e){this.onFailure(e)},fireDataChanged:function(){var e=this,t=e.name||"w121-data";e.dataChanged(e.data),$(document).trigger($.Event("datachanged."+t),[t,e]).trigger($.Event("datachanged"),[t,e]),e.afterSet(e.data)},loadData:function(){var e=this,t=$.extend({data:e.params,dataType:"json",success:function(){e.success.apply(e,arguments)},error:function(){e.failure.apply(e,arguments)}},e.ajaxConfig),n=e.setParams.apply(e,arguments),i=e.beforeLoad.apply(e,arguments);return n!==!1&&i!==!1?(e.lastRequest&&4!=e.lastRequest.readyState&&e.lastRequest.abort(),e.lastRequest=$.ajax(e.url,t),e.lastRequest):$.Deferred().reject()},onFailure:function(){},onSuccess:function(){},processData:function(e){return e},push:function(){var e=Array.prototype.push.apply(this.data||(this.data=[]),arguments);return this.total=this.data.length,this.fireDataChanged(),e},setParams:function(e){e&&"object"==typeof e&&$.extend(this.params,e)},setData:function(e,t){var n=this;n.beforeSet(e),n.data=n.processData(e),n.total=$.isNumeric(t)?t:n.data?n.data.length:0,n.fireDataChanged()},splice:function(){var e=Array.prototype.splice.apply(this.data||(this.data=[]),arguments);return this.total=this.data.length,this.fireDataChanged(),e},success:function(e){var t=this,n=Wui.unwrapData.call(t,e);t.onSuccess(e),t.setData(n.data,n.total)},totalContainer:null},Wui.Smarty=function(e){$.extend(this,{html:""},e,{compiled:null,build:[],__s:""})},Wui.Smarty.prototype={applyFlags:function(e,t){function n(e,t){var n=i.build[i.build.length-1];n.fn=n.fn||[],n.params=n.params||[],n.fn.push(e),n.params.push($.extend(!0,[],t))}for(var i=this,r=0;r<t.length;r++){for(var a,o=t[r].split(":"),s=1;s<o.length;s++)o[s]=i.trimSpecial(o[s],"\"'");a=o.shift(),"function"==a?(n("js_function",o),e=i.js_function.apply(i,o)):("default"==a&&(a="defaultVal"),"function"!=typeof i[a]?new Error("wui-smarty.js - Unsupported flag: '"+a+"'."):(n(a,o),o.splice(0,0,e),e=i[a].apply(i,o)))}return e},capitalize:function(e){return String(e).replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},chain:function(e,t){var n=this;return t.splice(0,0,n.__s),n.__s=n[e].apply(n,t),n},compile:function(){function e(e){return"['"+e.join("','")+"']"}for(var t=this,n='var me = this, retString = "";',i=0;i<t.build.length;i++){var r=t.build[i];if($.isPlainObject(r)){if(r.key.length>0?n+="me.__s = me.lookup(rec, '"+r.key+"');":"undefined"!=typeof r.fn&&(n+="me.__s = me."+r.fn.shift()+".apply(me, "+e(r.params.shift())+");"),"undefined"!=typeof r.fn&&r.fn.length>0){n+="me";for(var a=0;a<r.fn.length;a++)n+=".chain('"+r.fn[a]+"',"+e(r.params[a])+")";n+=";"}n+="retString += me.__s;"}else n+="retString += '"+t.escape(r,"javascript")+"';"}return n+="return retString;",Function.apply(null,["rec",n])},defaultVal:function(e,t){return e?e:t},escapeHTML:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},escapeJS:{"\\":"\\\\","'":"\\'",'"':'\\"',"\r":"\\r","\n":"\\n","</":"</"},escape:function(e,t,n){n=n||!1;var i=this,r={html:function(){var t=i.escapeHTML,r=n?i.invert(t):t,a=new RegExp("["+i.getKeys(r).join("").replace(/\//,"\\/")+"]","g");return String(e).replace(a,function(e){return r[e]})},javascript:function(){var t=i.escapeJS,r=n?i.invert(t):t,a=n?/\\\\|\\'|\\"|\\r|\\n|<\//g:/<\/|"|'|\\|\n|\r/g;return String(e).replace(a,function(e){return r[e]})},json:function(){var t=n?"parse":"stringify";return JSON[t](e)},url:function(){var t=n?"decodeURI":"encodeURI";return JSON[t](e)}};return"function"==typeof r[t]?r[t]():r.html()},getKeys:function(e){var t=[];return $.isPlainObject(e)&&$.each(e,function(e){t.push(e)}),t.sort()},hasProperty:function(e,t){return null!==e&&"object"==typeof e&&t in e},invert:function(e){var t={};return $.isPlainObject(e)&&!$.isEmptyObject(e)&&$.each(e,function(e,n){$.isArray(n)||$.isPlainObject(n)||$.isFunction(n)||(t[n]=e)}),t},js_function:function(e){var t=this,n=1,i=[];for(n;n<arguments.length;n++)i.push(t.lookup(t.rec,arguments[n]));return t[e].apply(t,i)},lookup:function(e,t){var n=this,i="";if(e.hasOwnProperty(t))i=e[t];else if(t.indexOf(".")>0)for(var r=e,a=t.split("."),o=0;null!==r&&o<a.length;)o===a.length-1&&n.hasProperty(r,a[o])&&(i=r[a[o]]),r=r[a[o++]];else n.hasProperty(e,t)&&(i=e[t]);return i},lower:function(e){return String(e).toLowerCase()},make:function(e){var t=this;if(!e||!t.html)throw new Error("wui-smarty.js - Template engine missing data and/or html template.");if(t.rec=e,null===t.compiled){var n=t.parse();return t.compiled=t.compile(),n}return t.compiled.call(t,e)},parse:function(){var e,t=this,n=0,i=t.html;return i=e=i.replace(/{\*[\w\s.,\/#!$%\^&\*;:{}=\-_`~()\[\]@]*\*}/g,""),i=i.replace(/{([\w+|:\. '"-]+)}/g,function(i,r,a){var o=r.split("|"),s=o.shift(),l="";return t.build.push(e.substr(n,a-n)),n=a+r.length+2,t.build.push({key:s}),l=t.lookup(t.rec,s),l=t.applyFlags(l,o)}),t.build.push(e.substr(n)),i},trimSpecial:function(e,t,n){if(n=n||"g","string"!=typeof e||"string"!=typeof t||"string"!=typeof n)throw new TypeError("argument must be string");if(!/^[gi]*$/.test(n))throw new TypeError("wui-smarty.js - Invalid regex flags supplied '"+n.match(new RegExp("[^gi]*"))+"'");return t=t.replace(/[\[\](){}?*+\^$\\.|\-]/g,"\\$&"),e.replace(new RegExp("^["+t+"]+|["+t+"]+$",n),"")},unescape:function(e,t){return this.escape(e,t,!0)},upper:function(e){return String(e).toUpperCase()}},Wui.Combo2=function(e,t){$.extend(this,{autoLoad:!1,ddCls:"",attr:{},noResultsMessage:"No Results.",field:$("<input>").attr({type:"text",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"}).addClass("wui-combo-search"),forceSelect:!1,hiddenCls:"wui-hidden",minKeys:1,placeholder:"",searchArgName:"filter",searchLocal:!0,searchThreshold:0,selected:[],showOpenButton:!0,template:null,templateFn:{},titleItem:null,valueItem:null},e,{multiSelect:!1}),this.init(t)},Wui.Combo2.prototype=$.extend(new Wui.Data,{addToDOM:function(e,t){var n=this,i=["append","prepend","before","after"];return Wui.isset(t)&&Wui.isset(e)||$.each(i,function(i,r){return Wui.isset(n[r])?(t=r,e=n[r],!1):void 0}),Wui.isset(t)||(t="append"),Wui.isset(e)||(e="body"),$(e)[t](n.el),n.cssByParam(),n.el},addMouseEnterListener:function(){var e=this,t="."+e.itemCls,n="wui-mm-bound";e.dd.hasClass(n)||e.dd.addClass(n).on("mousemove.wui_list_elements",t,function(t){t.stopPropagation(),e.selectListItem($(this)),e.mouseEnterListener&&clearInterval(e.mouseEnterListener)})},addTargetBinding:function(e){var t=this;return e.on("change",function(){t.val(e.val(),!1)}),t.el.on("valchange",function(n,i,r){e.val(t.valueToString(r))}),e},adjustDropDownSize:function(){var e,t=this,n=0,i=t.dd[0];Wui.isset(i.CSSRetrieved)||(i.CSSRetrieved=Wui.getStylesForElement(i),i.cssWidth=i.CSSRetrieved.width),t._open||t.dd.css({visibility:"hidden"}).removeClass(t.hiddenCls),t.dd.css({width:""}),isNaN(parseInt(i.cssWidth))&&0!==String(i.cssWidth).indexOf("calc")&&(e=t.el.innerWidth()<100?100:t.el.innerWidth(),n=t.dd.outerWidth()+Wui.getScrollbarWidth(),e=e>n?e:n,t.dd.width(e)),t._open||t.dd.addClass(t.hiddenCls)},argsByParam:function(){var e=this,t={},n={id:"id",name:"name",tabindex:"tabIndex",lang:"lang",title:"titleAttr"};$.each(n,function(n,i){var r=e[i];("string"==typeof r||"number"==typeof r)&&("name"==n?e.target.attr(n,r):t[n]=r)}),e.field.attr(t)},buildComboFromSelect:function(){var e=this,t=e.target;e.selectObserver(t),e.valueItem="value",e.titleItem="label",e.template||(e.engine.html=e.template="<li>{label}</li>"),e.setData(Wui.parseSelect(t))},buildComboFromJS:function(){var e=this,t=e.target[0];if((!e.hasOwnProperty("template")||null===e.template||void 0===e.template)&&e.hasOwnProperty("valueItem")&&e.hasOwnProperty("titleItem")&&e.valueItem&&e.titleItem&&(e.engine.html=e.template="<li>{"+e.titleItem+"|escape:html}</li>"),!e.template)throw new Error("Wui.js - valueItem and titleItem, or template, are required configs for a Combo.");Object.defineProperty(t,"value",{get:function(){return this.getAttribute("value")},set:function(t){this.setAttribute("value",t),e.target.trigger("change")}}),e.getSrcData()},close:function(){var e=this;e._open===!0&&(e.optionListEventsActive(!1),e.lockBodyScroll(),e._open=!1,e.dd.addClass(e.hiddenCls),e.el.find(".drop-down-switch").removeClass("open"),$.isPlainObject(e.value)&&e.setFieldValue(e.value[e.titleItem]),void 0!==e.isBlurring&&(e.isBlurring=!0,e.field.focus().select()))},createOptionListToggle:function(){var e,t=this;return t.showOpenButton?(e=$("<a>",{unselectable:"on",tabindex:-1}).addClass("wui-button drop-down-switch").html("").on({mousedown:function(){t.field.is(":focus")&&(t.isBlurring=!1)},click:function(e){e.preventDefault(),e.stopPropagation(),t._open===!0?t.close():t.field.mousedown()}}),t.el.addClass("wui-has-dd-btn"),e):void 0},cssByParam:function(){var e,t=this,n=t.el,i={};return t.argsByParam(),$.isEmptyObject(t.attr)||n.attr(t.attr),$.isNumeric(t.height)&&t.height>=0&&$.extend(i,{height:t.height}),$.isNumeric(t.width)&&t.width>=0&&$.extend(i,{width:t.width,flex:"none"}),Wui.isPercent(t.width)&&(e=Wui.percentToPixels(n,t.width,"width"),0!==e&&$.extend(i,{width:e,flex:"none"})),Wui.isPercent(t.height)&&(e=Wui.percentToPixels(n,t.height,"height"),0!==e&&$.extend(i,{height:e})),t.hidden&&$.extend(i,"display","none"),n.addClass(t.cls).css(i)},dataChanged:function(){this.make()},each:function(e,t){var n=this,i=0,r=n.items||n;if(!$.isArray(r))return!1;if(t!==!1)for(i;i<r.length&&e(r[i],i)!==!1;i++);else for(i=r.length;i>=0&&e(r[i],i)!==!1;i--);return!0},failure:function(e){var t=this;0!==e.status&&0!==e.readyState&&(t.el.removeClass("wui-loading").addClass("wui-error"),setTimeout(function(){t.el.removeClass("wui-error")},1e3))},getItemBy:function(e,t){var n,i=this;return i.each(function(i){return void 0!==i.rec[e]&&i.rec[e]===t||$.isNumeric(t)&&parseFloat(t)==parseFloat(i.rec[e])?(n=i,!1):void 0}),n},getSrcData:function(){var e=this;return e.initLoaded!==!0&&$.isArray(e.data)&&e.data.length>0?(e.setParams(e.params),e.initLoaded=!0,e.setData(e.data)):e.autoLoad?null!==this.url?e.loadData():e.setData(e.data):void 0},getVal:function(){var e=this,t=$.isPlainObject(e.value)&&Wui.isset(e.value[e.valueItem])?e.value[e.valueItem]:e.value;return t},hilightText:function(e){function t(e){return $(e).find("."+o).each(function(){var e=this.parentNode;e.replaceChild(this.firstChild,this),e.normalize()}).end()}function n(e,t){return e.parentNode.insertBefore(t,e.nextSibling),t}function i(e){var t,i=e.parentNode,r=[],a=e.nodeValue,l=0,u=e;if(3===e.nodeType){for(;t=s.exec(a);)r.push(t.index,s.lastIndex);0!==r.length&&(r.forEach(function(e,t){t%2===0?(e!=l&&(u=n(u,document.createTextNode(a.slice(l,e)))),u=n(u,$("<span>",{"class":o}).text(a.slice(e,r[t+1]))[0])):l=e}),l!=a.length&&n(u,document.createTextNode(a.slice(l))),i.removeChild(e))}}function r(e){var n=e instanceof jQuery?e[0]:e;return t(e),n.normalize(),Array.prototype.forEach.call(n.childNodes,function(e){3==e.nodeType&&e.nodeValue.replace(/^\s+|\s+$/g,"").length>0?i(e):e.hasChildNodes()&&r(e)}),$(e)}var a=this,o=a.highlightCls,s=new RegExp(e,"ig");Wui.isset(e)&&0!==$.trim(e).length?(a.dd.find(".wui-optgroup-label."+a.hiddenCls).removeClass(a.hiddenCls),a.dd.find("."+a.noResultsCls).remove(),a.searchHTMLText(e,function(e){r(e).removeClass(a.hiddenCls)},function(e){t(e).addClass(a.hiddenCls)}),a.dd.children("."+a.disabledItemCls).addClass(a.hiddenCls),a.dd.children(".wui-optgroup-label").each(function(){var e=$(arguments[1]);0===e.children("ul").children(":visible").length&&e.addClass(a.hiddenCls)}),0===a.dd.children(":visible").length&&a.dd.prepend('<li class="'+a.noResultsCls+" "+a.disabledItemCls+'">'+a.noResultsMessage+"</li>")):a.resetListHilighting(),Wui.positionItem(a.el,a.dd)},init:function(e){var t=this;t.el=$("<div>").addClass("wui-form-field").append(t._setListeners()),e=$(e),1===e.length&&(e[0]instanceof HTMLSelectElement||e[0]instanceof HTMLInputElement&&("text"==e[0].type||"hidden"==e[0].type))?t.target=e.after(t.el).addClass(t.hiddenCls).prependTo(t.el):(t.target=$('<input type="hidden">').prependTo(t.el),t.addToDOM()),$.extend(t,{disabledItemCls:"wui-combo-disabled",engine:new Wui.Smarty($.extend({html:t.template},t.templateFn)),highlightCls:"wui-highlight",idCls:Wui.id(t.target.attr("name")),itemCls:"wui-list-item",items:[],noResultsCls:"no-results",multiSelect:t.multiSelect===!0||t.target&&t.target.prop("multiple")===!0,searchLocal:null===t.url||t.autoLoad===!0,value:t.hasOwnProperty("value")?t.value:null}),$("body").append(t.dd=$("<ul>").addClass("wui-combo-dd "+t.hiddenCls+" "+t.ddCls).on("click","."+t.disabledItemCls,function(){t.field.focus()})),t.setPlaceholder(t.placeholder),t.el.addClass("wui-combo "+t.idCls).append(t.createOptionListToggle()),t.target[0]instanceof HTMLSelectElement?t.buildComboFromSelect():t.buildComboFromJS(),t.addTargetBinding(t.target),t.cssByParam(),t.target[0].wuiObj=t,t.val(t.target.val(),!1),t.toggleFieldSearchability()},itemDeselect:function(e){var t=this;return t.selected.length>0?(e.el.removeClass("wui-selected"),t.selected=[],t.el.trigger($.Event("wuideselect"),[t,e.el,e.rec]).trigger($.Event("wuichange"),[t,e.el,e.rec,t.selected]),e):void 0},itemSelect:function(e,t){var n=this;return e&&(n.dd.find(".wui-selected").removeClass("wui-selected"),e.el.addClass("wui-selected"),n.selected=[e],n.multiSelect||t||n.el.trigger($.Event("wuiselect"),[n,e.el,e.rec]).trigger($.Event("wuichange"),[n,e.el,e.rec,n.selected])),e},loadData:function(){var e=this;return e.el.addClass("wui-loading"),Wui.Data.prototype.loadData.apply(e,arguments)},lockBodyScroll:function(e){var t,n=this,i=$("body"),r=$(window),a="wui-combo-no-scroll",o="resize.wui-combo2";return e===!0&&i.outerHeight(!0)>$.viewportH()?(i.css({top:-1*r.scrollTop(),width:i.width()}).addClass(a),r.on(o,function(){n.lockBodyScroll(),n.sizeAndPositionDD(),i.css({width:i.width()}),n.lockBodyScroll(!0)})):(t=-1*parseInt(i.css("top")),i.removeClass(a).css({top:"",width:""}),r.scrollTop(t).off(o)),i},make:function(){var e=this,t=$("<div>"),n={};return e.items=[],e.data.forEach(function(i){var r=e.engine.make(i),a={el:$(r),rec:i};e.items.push(a),i.disabled!==!0?a.el.data("itm",a).addClass(e.itemCls):a.el.addClass("wui-combo-disabled"),Wui.isset(i.optgroup)&&0!==String(i.optgroup).length?Wui.isset(n[i.optgroup])?n[i.optgroup].find("ul").append(a.el):t.append(n[i.optgroup]=$('<li class="wui-optgroup-label">'+i.optgroup+'<ul class="wui-optgroup"></ul></li>').find("ul").append(a.el).end()):t.append(a.el)}),e.dd.empty().append(t.children()).off("mousedown").on("mousedown",function(){e.isBlurring=!1}),0===e.data.length?e.dd.html(e.noResultsMessage):e.hilightText(e.previous),e.sizeAndPositionDD(),e.el.removeClass("wui-loading"),e.items.length},notFound:function(){},optionListEventsActive:function(e){var t=this,n="."+t.itemCls;t.optionListMouseEnter(e),e?(t.dd.on("mousedown",n,function(e){e.stopPropagation(),t.isBlurring=!1}).on("click",n,function(e){t.selectListItem($(this)),e.stopPropagation(),t.set(),t.close()}).one("mousemove",function(){t.optionListMouseEnter(!0)}),t.dd.children(n).each(function(){$(this).bind("touchstart",function(e){e.stopPropagation(),e.preventDefault(),t.isBlurring=!1})})):(t.dd.off("mousemove mousedown click"),t.dd.children(n).each(function(){$(this).unbind("touchstart")}))},optionListMouseEnter:function(e){var t=this,n="wui-mm-bound";e?t.mouseEnterListener=setTimeout(function(){t.addMouseEnterListener()},300):(t.mouseEnterListener&&clearInterval(t.mouseEnterListener),t.dd.off("mousemove.wui_list_elements").removeClass(n).one("mousemove",function(){t.optionListMouseEnter(!0)}))},open:function(){var e=this;e._open||(e._open=!0,e.lockBodyScroll(!0),e.el.find(".drop-down-switch").addClass("open"),e.resetListHilighting(),e.optionListEventsActive(!0),$(document).one("click:"+e.idCls,"*:not(."+e.idCls+" input)",function(t){t.target!==e.field[0]&&(e.setVal(e.value),e.close())}),e.sizeAndPositionDD(),e.field.focus().select(),e.addMouseEnterListener())},resetListHilighting:function(){var e=this;e.dd.find("."+e.noResultsCls).remove(),e.dd.find("."+e.hiddenCls).removeClass(e.hiddenCls),e.dd.find("."+e.highlightCls).each(function(){$(this).replaceWith($(this).html())})},scrollToCurrent:function(){var e=this,t=e.dd.find(".wui-selected:first"),n=t.offsetParent(),i=function(){var n=0;return t.prevAll().each(function(){n+=$(this).outerHeight()}),n-=e.dd.height()/2-t.outerHeight()/2}();e.optionListMouseEnter(!1),n.animate({scrollTop:i},100)},searchData:function(){var e=this,t=$.trim(e.field[0].value),n=e.previous||void 0,i={};e.previous=t,e.searchLocal?e.hilightText(t):(t.length>=e.minKeys||0===t.length)&&e.previous!=n&&(i[e.searchArgName]=t,e.loadData(i))},searchHTMLText:function(e,t,n){var i=this,r=i.items.map(function(e){return e.el});i.each.call(r,function(i){return i.text().toUpperCase().indexOf(e.toUpperCase())>=0&&"function"==typeof t?t(i):"function"==typeof n?n(i):void 0})},selectAjacent:function(e){var t,n,i=this,r=i.items.map(function(e){return e.rec.disabled!==!0&&e.el.is(":visible")?e.el:void 0}).filter(function(e){return void 0!==e}),a=function(e){var t;return e.length>0&&r.forEach(function(n,i){return n[0]===e[0].el[0]?(t=i,!1):void 0}),t}(i.selected),o=e>0?0:r.length-1;i.justOpened===!0&&(e=0,i.justOpened=!1),n=$.isNumeric(a)?r[a+e]:r[o],t=i.selectByEl(n),$.isPlainObject(t)||(t=i.selectByEl(r[o]))},selectBy:function(){var e=this,t=e.getItemBy.apply(e,arguments);return e.itemSelect(t)},selectByEl:function(e,t){var n,i=this;return i.itemSelect(n=$(e).data("itm")),t!==!1&&i.scrollToCurrent(),n},selectCurrent:function(){var e,t=this;t.value&&0===t.field.val().length&&(e=t.selectBy(t.valueItem,t.value)),!Wui.isset(e)&&$.isPlainObject(t.value)&&(e=t.selectBy(t.valueItem,t.value[t.valueItem])),Wui.isset(e)?t.set():t.notFound()},selectListItem:function(e){var t=this;Wui.isset(t.selected[0])||t.itemSelect(e.data("itm")),t.selected[0].el[0]!==e[0]&&t.itemSelect(e.data("itm"))},selectObserver:function(e){function t(e){e._selected=e.selected,Object.defineProperty(e,"selected",{get:function(){return e._selected},set:function(t){e._selected=t&&e.disabled!==!0,e[e._selected?"setAttribute":"removeAttribute"]("selected",!0),n(t)}})}function n(n){var r,a=e[0],o=a.options,s=o.length,l=s;if(i.target&&s!=i.total)for(i.setData(Wui.parseSelect(i.target));l--;)r=o[l],Wui.isset(r._selected)||t(r);Wui.isset(a.observer_count)?a.observer_count++:a.observer_count=1,n===!0&&(a.hasSelected=!0),a.observer_count==s&&(a.hasSelected===!0?setTimeout(function(){for(l=s;l--;)r=o[l],r._selected&&(a.selectedIndex=l);e.trigger("change")},0):a.selectedIndex=-1,a.observer_count=0,a.hasSelected=!1)}var i=this;return e.attr("autocomplete","off"),Object.defineProperty(e[0],"value",{get:function(){return $.valHooks.select.get(this)},set:function(e){$.valHooks.select.set(this,e)}}),e.find("option").each(function(e,n){t(n)}),e},set:function(){var e=this,t=e.selected[0];t&&(e.value!==t.rec&&e.val(t.rec),t.rec.disabled!==!0?(e.setFieldValue(t.rec[e.titleItem]),e.setPlaceholder(""),e.toggleFieldSearchability()):e.setPlaceholder(t.rec[e.titleItem])),e._open&&e.close()},_setChanged:function(e){var t=this;t.parent&&t.parent instanceof Wui.Form&&t.parent.formChange(!0,t),t.el.trigger($.Event("valchange"),[t,t.value,e])},setFieldValue:function(e){var t=this,n=$.trim(e);return e=n,t.value&&t.value.disabled!==!0&&0===n.length&&0===$.trim(t.value[t.valueItem]).length&&(n="A blank value is selected."),t.field.val(e)[n.length>0?"attr":"removeAttr"]("title",n),t.field},_setListeners:function(){var e=this,t={TAB:9,ENTER:13,SHIFT:16,ESC:27,UP:38,DOWN:40};return e.field.on("keydown",function(n){if(n.keyCode==t.ENTER?(e.can_search=!1,e._open&&(n.stopPropagation(),n.preventDefault(),e.set())):n.stopPropagation(),e.items.length<e.searchThreshold&&e.searchLocal&&n.keyCode!=t.TAB&&n.preventDefault(),n.keyCode==t.SHIFT)return!1;if(n.keyCode==t.TAB)e._open?e.forceSelect&&n.preventDefault():e.set();else if(-1==$.inArray(n.keyCode,[t.ENTER,t.SHIFT])&&(e._open||(e.justOpened=!0),e.open()),-1!=$.inArray(n.keyCode,[t.DOWN,t.UP,t.ESC]))switch(n.preventDefault(),e.can_search=!1,n.keyCode){case t.DOWN:e.selectAjacent(1);break;case t.UP:e.selectAjacent(-1);break;case t.ESC:e.setVal(e.value),e.close()}else e.can_search=!0}).on("keyup",function(n){var i=null;n.keyCode==t.ENTER?e._open&&(n.stopPropagation(),n.preventDefault(),e.set()):n.stopPropagation(),e.can_search&&-1==$.inArray(n.keyCode,[t.TAB,t.SHIFT])&&(e.total>=e.searchThreshold||!e.searchLocal?e.searchData():0===n.which||n.ctrlKey||n.metaKey||n.altKey||(i=String.fromCharCode(n.which),Wui.isset(e.selectTypeBuffer)?e.selectTypeBuffer+=i:(e.selectTypeBuffer=i,setTimeout(function(){e.selectTypeBuffer=void 0},1e3)),e.searchHTMLText(e.selectTypeBuffer,function(t){e.selectByEl(t)})))}).on("focus",function(t){t.stopPropagation(),e.isBlurring!==!0&&(e.target&&void 0===e.isBlurring&&e.target.triggerHandler("focus"),e.isBlurring=void 0,e.el.addClass("wui-fe-focus"))}).on("blur",function(){e.isBlurring!==!1&&(e.close(),e.isBlurring=void 0,e.el.removeClass("wui-fe-focus"))}).on("mousedown",function(t){$(this).is(":focus")||t.preventDefault(),e.open()})},setPlaceholder:function(e){var t=this;return t.placeholder=e,t.field.attr("placeholder",e),e},setVal:function(e){var t=this,n=$.isPlainObject(e)?e[t.valueItem]:e,i=t.selectBy(t.valueItem,n);return $.isPlainObject(i)?(t.value=i.rec,t.set(),i):void 0},sizeAndPositionDD:function(){var e=this;e.dd.css({visibility:"hidden"}).removeClass(e.hiddenCls),e.adjustDropDownSize(),Wui.positionItem(e.el,e.dd),e.dd.css("visibility",""),$.isPlainObject(e.value)&&(e.getItemBy(e.valueItem,e.value[e.valueItem]),e.scrollToCurrent())},toggleFieldSearchability:function(){var e=this,t=e.items.length>=e.searchThreshold||!e.searchLocal,n=0===e.selected.length||0===e.field.val().length;t&&n?(e.el.addClass("wui-combo-searchable"),e.field.prop("readonly",!1)):(e.el.removeClass("wui-combo-searchable"),t||e.field.prop("readonly",!0))},val:function(){var e=this;if(arguments.length){var t=e.value;return e.setVal.apply(e,arguments),arguments[1]!==!1&&e._setChanged(t),arguments}return e.getVal()},valueToString:function(e){var t,n=this;return null===e?(t=n.getItemBy(n.valueItem,e),Wui.isset(t)?e:""):$.isPlainObject(e)?e[n.valueItem]:e}});